<h1>Returning Data with JSON</h1>

<p>Andromeda allows you to send raw data back to the browser
   which can then be put to any purpose.
</p>

<p>The example below shows a routine that requests some data
   from the server, and takes the resulting data and 
   renders an HTML Table.
<p>

<pre><span class="syntax0"><span class="syntax17">&lt;?php</span>
<span class="syntax8">class</span><span class="syntax8"> </span><span class="syntax11">x6jsonexample</span><span class="syntax11"> </span><span class="syntax8">extends</span><span class="syntax11"> </span><span class="syntax11">androX6</span><span class="syntax11"> </span><span class="syntax18">{</span>
    <span class="syntax8">function</span> <span class="syntax6">x6main</span><span class="syntax18">(</span><span class="syntax18">)</span> <span class="syntax18">{</span>
        <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">Conventional</span><span class="syntax4"> </span><span class="syntax4">HTML</span><span class="syntax4"> </span><span class="syntax4">generation...</span>
        <span class="syntax10">$top</span> <span class="syntax18">=</span> <span class="syntax17">html</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">div</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$top</span><span class="syntax6">-&gt;h</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">h1</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Hello</span><span class="syntax13"> </span><span class="syntax13">JSON/DATA</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
        
        <span class="syntax10">$input</span> <span class="syntax18">=</span> <span class="syntax11">$top</span><span class="syntax6">-&gt;h</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">input</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Fetch</span><span class="syntax13"> </span><span class="syntax13">Data</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$input</span><span class="syntax11">-&gt;hp</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">type</span><span class="syntax13">'</span><span class="syntax18">]</span> <span class="syntax18">=</span> <span class="syntax13">'</span><span class="syntax13">button</span><span class="syntax13">'</span><span class="syntax18">;</span>
        <span class="syntax11">$input</span><span class="syntax11">-&gt;code</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">click</span><span class="syntax13">'</span><span class="syntax18">]</span> <span class="syntax18">=</span> <span class="syntax17">&lt;&lt;&lt;JS</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax8">function</span><span class="syntax18">(</span><span class="syntax17">e</span><span class="syntax18">)</span><span class="syntax17"> </span><span class="syntax18">{</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17">ua</span><span class="syntax18">.</span><span class="syntax17">json</span><span class="syntax18">.</span><span class="syntax6">init</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">x6page</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">jsonexample</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17">ua</span><span class="syntax18">.</span><span class="syntax17">json</span><span class="syntax18">.</span><span class="syntax6">addParm</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">x6action</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">gimmeData</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax8">if</span><span class="syntax18">(</span><span class="syntax17">ua</span><span class="syntax18">.</span><span class="syntax17">json</span><span class="syntax18">.</span><span class="syntax6">execute</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax17"> </span><span class="syntax18">{</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17">html</span><span class="syntax17"> </span><span class="syntax18">=</span><span class="syntax17"> </span><span class="syntax13">'</span><span class="syntax13">&lt;</span><span class="syntax13">table</span><span class="syntax13">&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">The</span><span class="syntax2"> </span><span class="syntax2">data</span><span class="syntax2"> </span><span class="syntax2">that</span><span class="syntax2"> </span><span class="syntax2">came</span><span class="syntax2"> </span><span class="syntax2">back</span><span class="syntax2"> </span><span class="syntax2">can</span><span class="syntax2"> </span><span class="syntax2">be</span><span class="syntax2"> </span><span class="syntax2">found</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">in</span><span class="syntax2"> </span><span class="syntax2">&quot;ua.data&quot;</span><span class="syntax2"> </span><span class="syntax2">plus</span><span class="syntax2"> </span><span class="syntax2">the</span><span class="syntax2"> </span><span class="syntax2">name</span><span class="syntax2"> </span><span class="syntax2">provided</span><span class="syntax2"> </span><span class="syntax2">by</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">the</span><span class="syntax2"> </span><span class="syntax2">servers-side</span><span class="syntax2"> </span><span class="syntax2">routine.</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax8">for</span><span class="syntax18">(</span><span class="syntax8">var</span><span class="syntax17"> </span><span class="syntax17">y</span><span class="syntax17"> </span><span class="syntax8">in</span><span class="syntax17"> </span><span class="syntax17">ua</span><span class="syntax18">.</span><span class="syntax17">data</span><span class="syntax18">.</span><span class="syntax17">exampStuff</span><span class="syntax18">)</span><span class="syntax17"> </span><span class="syntax18">{</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17">html</span><span class="syntax18">+</span><span class="syntax18">=</span><span class="syntax13">'</span><span class="syntax13">&lt;</span><span class="syntax13">tr</span><span class="syntax13">&gt;</span><span class="syntax13">'</span><span class="syntax18">;</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax8">for</span><span class="syntax18">(</span><span class="syntax8">var</span><span class="syntax17"> </span><span class="syntax17">x</span><span class="syntax17"> </span><span class="syntax8">in</span><span class="syntax17"> </span><span class="syntax17">ua</span><span class="syntax18">.</span><span class="syntax17">data</span><span class="syntax18">.</span><span class="syntax17">exampStuff</span><span class="syntax18">[</span><span class="syntax17">y</span><span class="syntax18">]</span><span class="syntax18">)</span><span class="syntax17"> </span><span class="syntax18">{</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17">html</span><span class="syntax18">+</span><span class="syntax18">=</span><span class="syntax13">'</span><span class="syntax13">&lt;</span><span class="syntax13">td</span><span class="syntax13">&gt;</span><span class="syntax13">'</span><span class="syntax18">+</span><span class="syntax17">ua</span><span class="syntax18">.</span><span class="syntax17">data</span><span class="syntax18">.</span><span class="syntax17">exampStuff</span><span class="syntax18">[</span><span class="syntax17">y</span><span class="syntax18">]</span><span class="syntax18">[</span><span class="syntax17">x</span><span class="syntax18">]</span><span class="syntax18">;</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax18">}</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax18">}</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17">html</span><span class="syntax18">+</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">&lt;</span><span class="syntax14">/</span><span class="syntax14">table</span><span class="syntax14">&gt;</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17">$</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">#</span><span class="syntax13">put_table_here</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">.</span><span class="syntax6">html</span><span class="syntax18">(</span><span class="syntax17">html</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax18">}</span>
<span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax17"> </span><span class="syntax18">}</span>
<span class="syntax17">JS</span><span class="syntax18">;</span>
    
        <span class="syntax10">$div</span> <span class="syntax18">=</span> <span class="syntax11">$top</span><span class="syntax6">-&gt;h</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">div</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$div</span><span class="syntax11">-&gt;hp</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">id</span><span class="syntax13">'</span><span class="syntax18">]</span> <span class="syntax18">=</span> <span class="syntax13">'</span><span class="syntax13">put_table_here</span><span class="syntax13">'</span><span class="syntax18">;</span>
        <span class="syntax11">$top</span><span class="syntax6">-&gt;render</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">;</span>
    <span class="syntax18">}</span>
    
    <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">This</span><span class="syntax4"> </span><span class="syntax4">routine</span><span class="syntax4"> </span><span class="syntax4">handles</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">call</span>
    <span class="syntax8">function</span> <span class="syntax6">gimmeData</span><span class="syntax18">(</span><span class="syntax18">)</span> <span class="syntax18">{</span>
        <span class="syntax10">$data</span> <span class="syntax18">=</span> <span class="syntax8">array</span><span class="syntax18">(</span>
            <span class="syntax8">array</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">a</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">b</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">c</span><span class="syntax13">'</span><span class="syntax18">)</span>
           <span class="syntax18">,</span><span class="syntax8">array</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">x</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">y</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">z</span><span class="syntax13">'</span><span class="syntax18">)</span>
           <span class="syntax18">,</span><span class="syntax8">array</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">1</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">2</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">3</span><span class="syntax13">'</span><span class="syntax18">)</span>
           <span class="syntax18">,</span><span class="syntax8">array</span><span class="syntax18">(</span> <span class="syntax5">4</span> <span class="syntax18">,</span> <span class="syntax5">5</span> <span class="syntax18">,</span> <span class="syntax5">6</span> <span class="syntax18">)</span>
        <span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax6">x6data</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">exampStuff</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax10">$data</span><span class="syntax18">)</span><span class="syntax18">;</span>
    <span class="syntax18">}</span>
<span class="syntax18">}</span>
<span class="syntax17">?&gt;</span>
</span></pre>

<p>All of the code in x6main should be familiar now, so we will
   concentrate on the function gimmeData(), which is invoked by
   JSON call from the browser when the user clicks the button.
</p>

<p>The example first generates an array of arrays, and then 
   goes directly to the x6data() call.  The x6data() function
   says, "here is some data to send back to the browser."
   The function has two parameters.
   The first is the name of the data element, which can be anything.
   The second is the data itself.
</p>

<p>Now looking up towards the Javascript, we see that the data we
   sent back with the name "exampStuff" can be found browser-side
   in the "ua.data" object as "ua.data.exampStuff".  After that
   it is a matter of simply recursing through the data and 
   generating a simple HTML table by way of example.
</p>

<span class="note">This is an ideal method for sending database
   rows back to the browser.  
</span>
