<html>
<head>
<title>p_orders.php</title>
<style type="text/css"><!--
.syntax0 {
color: #666666;
}
.syntax1 {
color: #cc0000;
}
.syntax2 {
color: #ff9900;
}
.syntax3 {
color: #6600cc;
}
.syntax4 {
color: #cc6600;
}
.syntax5 {
color: #ff0000;
}
.syntax6 {
color: #009933;
}
.syntax7 {
background: #ffffcc;
color: #ff0066;
}
.syntax8 {
color: #006699;
font-weight: bold;
}
.syntax9 {
color: #009966;
font-weight: bold;
}
.syntax10 {
color: #0099ff;
font-weight: bold;
}
.syntax11 {
color: #66ccff;
font-weight: bold;
}
.syntax12 {
color: #02b902;
}
.syntax13 {
color: #ff00cc;
}
.syntax14 {
color: #cc00cc;
}
.syntax15 {
color: #9900cc;
}
.syntax16 {
color: #6600cc;
}
.syntax17 {
color: #0000ff;
}
.syntax18 {
color: #000000;
font-weight: bold;
}
--></style>
</head>
<body bgcolor="#f0f0f0">
<pre><span class="syntax0"><span class="syntax17">&lt;?php</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">======================================================================</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">(C)</span><span class="syntax4"> </span><span class="syntax4">Copyright</span><span class="syntax4"> </span><span class="syntax4">2008</span><span class="syntax4"> </span><span class="syntax4">by</span><span class="syntax4"> </span><span class="syntax4">Secure</span><span class="syntax4"> </span><span class="syntax4">Data</span><span class="syntax4"> </span><span class="syntax4">Software,</span><span class="syntax4"> </span><span class="syntax4">Inc.</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4"> </span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">&quot;BOOKKEEP&quot;</span><span class="syntax4"> </span><span class="syntax4">is</span><span class="syntax4"> </span><span class="syntax4">free</span><span class="syntax4"> </span><span class="syntax4">software;</span><span class="syntax4"> </span><span class="syntax4">you</span><span class="syntax4"> </span><span class="syntax4">can</span><span class="syntax4"> </span><span class="syntax4">redistribute</span><span class="syntax4"> </span><span class="syntax4">it</span><span class="syntax4"> </span><span class="syntax4">and/or</span><span class="syntax4"> </span><span class="syntax4">modify</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">it</span><span class="syntax4"> </span><span class="syntax4">under</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">terms</span><span class="syntax4"> </span><span class="syntax4">of</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">GNU</span><span class="syntax4"> </span><span class="syntax4">General</span><span class="syntax4"> </span><span class="syntax4">Public</span><span class="syntax4"> </span><span class="syntax4">License</span><span class="syntax4"> </span><span class="syntax4">as</span><span class="syntax4"> </span><span class="syntax4">published</span><span class="syntax4"> </span><span class="syntax4">by</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">Free</span><span class="syntax4"> </span><span class="syntax4">Software</span><span class="syntax4"> </span><span class="syntax4">Foundation;</span><span class="syntax4"> </span><span class="syntax4">either</span><span class="syntax4"> </span><span class="syntax4">version</span><span class="syntax4"> </span><span class="syntax4">2</span><span class="syntax4"> </span><span class="syntax4">of</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">License,</span><span class="syntax4"> </span><span class="syntax4">or</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">(at</span><span class="syntax4"> </span><span class="syntax4">your</span><span class="syntax4"> </span><span class="syntax4">option)</span><span class="syntax4"> </span><span class="syntax4">any</span><span class="syntax4"> </span><span class="syntax4">later</span><span class="syntax4"> </span><span class="syntax4">version.</span>
<span class="syntax4">#</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">BOOKKEEP</span><span class="syntax4"> </span><span class="syntax4">is</span><span class="syntax4"> </span><span class="syntax4">distributed</span><span class="syntax4"> </span><span class="syntax4">in</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">hope</span><span class="syntax4"> </span><span class="syntax4">that</span><span class="syntax4"> </span><span class="syntax4">it</span><span class="syntax4"> </span><span class="syntax4">will</span><span class="syntax4"> </span><span class="syntax4">be</span><span class="syntax4"> </span><span class="syntax4">useful,</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">but</span><span class="syntax4"> </span><span class="syntax4">WITHOUT</span><span class="syntax4"> </span><span class="syntax4">ANY</span><span class="syntax4"> </span><span class="syntax4">WARRANTY;</span><span class="syntax4"> </span><span class="syntax4">without</span><span class="syntax4"> </span><span class="syntax4">even</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">implied</span><span class="syntax4"> </span><span class="syntax4">warranty</span><span class="syntax4"> </span><span class="syntax4">of</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">MERCHANTABILITY</span><span class="syntax4"> </span><span class="syntax4">or</span><span class="syntax4"> </span><span class="syntax4">FITNESS</span><span class="syntax4"> </span><span class="syntax4">FOR</span><span class="syntax4"> </span><span class="syntax4">A</span><span class="syntax4"> </span><span class="syntax4">PARTICULAR</span><span class="syntax4"> </span><span class="syntax4">PURPOSE.</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">See</span><span class="syntax4"> </span><span class="syntax4">the</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">GNU</span><span class="syntax4"> </span><span class="syntax4">General</span><span class="syntax4"> </span><span class="syntax4">Public</span><span class="syntax4"> </span><span class="syntax4">License</span><span class="syntax4"> </span><span class="syntax4">for</span><span class="syntax4"> </span><span class="syntax4">more</span><span class="syntax4"> </span><span class="syntax4">details.</span>
<span class="syntax4">#</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">You</span><span class="syntax4"> </span><span class="syntax4">should</span><span class="syntax4"> </span><span class="syntax4">have</span><span class="syntax4"> </span><span class="syntax4">received</span><span class="syntax4"> </span><span class="syntax4">a</span><span class="syntax4"> </span><span class="syntax4">copy</span><span class="syntax4"> </span><span class="syntax4">of</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">GNU</span><span class="syntax4"> </span><span class="syntax4">General</span><span class="syntax4"> </span><span class="syntax4">Public</span><span class="syntax4"> </span><span class="syntax4">License</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">along</span><span class="syntax4"> </span><span class="syntax4">with</span><span class="syntax4"> </span><span class="syntax4">BOOKKEEP;</span><span class="syntax4"> </span><span class="syntax4">if</span><span class="syntax4"> </span><span class="syntax4">not,</span><span class="syntax4"> </span><span class="syntax4">write</span><span class="syntax4"> </span><span class="syntax4">to</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">Free</span><span class="syntax4"> </span><span class="syntax4">Software</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">Foundation,</span><span class="syntax4"> </span><span class="syntax4">Inc.,</span><span class="syntax4"> </span><span class="syntax4">51</span><span class="syntax4"> </span><span class="syntax4">Franklin</span><span class="syntax4"> </span><span class="syntax4">St,</span><span class="syntax4"> </span><span class="syntax4">Fifth</span><span class="syntax4"> </span><span class="syntax4">Floor,</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">Boston,</span><span class="syntax4"> </span><span class="syntax4">MA</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">02110-1301</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">USA</span><span class="syntax4"> </span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">or</span><span class="syntax4"> </span><span class="syntax4">visit</span><span class="syntax4"> </span><span class="syntax4">http://www.gnu.org/licenses/gpl.html</span>
<span class="syntax4">#</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">======================================================================</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">This</span><span class="syntax4"> </span><span class="syntax4">custom</span><span class="syntax4"> </span><span class="syntax4">file</span><span class="syntax4"> </span><span class="syntax4">prints</span><span class="syntax4"> </span><span class="syntax4">out</span><span class="syntax4"> </span><span class="syntax4">orders</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">This</span><span class="syntax4"> </span><span class="syntax4">is</span><span class="syntax4"> </span><span class="syntax4">a</span><span class="syntax4"> </span><span class="syntax4">purely</span><span class="syntax4"> </span><span class="syntax4">manual</span><span class="syntax4"> </span><span class="syntax4">report,</span><span class="syntax4"> </span><span class="syntax4">mostly</span><span class="syntax4"> </span><span class="syntax4">using</span><span class="syntax4"> </span><span class="syntax4">direct</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">calls</span><span class="syntax4"> </span><span class="syntax4">to</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">underlying</span><span class="syntax4"> </span><span class="syntax4">fpdf</span><span class="syntax4"> </span><span class="syntax4">library</span>
<span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">======================================================================</span>
<span class="syntax8">include</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">fpdf153/fpdf.php</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
<span class="syntax8">class</span><span class="syntax8"> </span><span class="syntax11">p_orders</span><span class="syntax11"> </span><span class="syntax8">extends</span><span class="syntax11"> </span><span class="syntax11">x_table2</span><span class="syntax11"> </span><span class="syntax18">{</span>
    <span class="syntax8">function</span> <span class="syntax9">main</span><span class="syntax18">(</span><span class="syntax18">)</span> <span class="syntax18">{</span>
        <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">First</span><span class="syntax4"> </span><span class="syntax4">retrieve</span><span class="syntax4"> </span><span class="syntax4">all</span><span class="syntax4"> </span><span class="syntax4">orders</span><span class="syntax4"> </span>
        <span class="syntax8">if</span><span class="syntax18">(</span><span class="syntax6">gpExists</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">order</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">)</span> <span class="syntax18">{</span>
            <span class="syntax10">$sWhere</span> <span class="syntax18">=</span> <span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">WHERE</span><span class="syntax13"> </span><span class="syntax13">o.recnum_ord</span><span class="syntax13"> </span><span class="syntax13">=</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span><span class="syntax6">SQLFN</span><span class="syntax18">(</span><span class="syntax6">gp</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">order</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax18">}</span>
        <span class="syntax8">else</span> <span class="syntax18">{</span>
            <span class="syntax10">$sWhere</span> <span class="syntax18">=</span> <span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">WHERE</span><span class="syntax13"> </span><span class="syntax13">o.recnum_op</span><span class="syntax13"> </span><span class="syntax13">=</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span><span class="syntax6">SQLFN</span><span class="syntax18">(</span><span class="syntax6">gp</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">batch</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax18">}</span>
        <span class="syntax10">$orders</span> <span class="syntax18">=</span> <span class="syntax6">SQL_AllRows</span><span class="syntax18">(</span>
            <span class="syntax14">&quot;</span><span class="syntax14">SELECT</span><span class="syntax14"> </span><span class="syntax14">o</span><span class="syntax14">.</span><span class="syntax14">*</span><span class="syntax14">,</span><span class="syntax14">c</span><span class="syntax14">.</span><span class="syntax14">description</span><span class="syntax14">,</span><span class="syntax14">c</span><span class="syntax14">.</span><span class="syntax14">add1</span><span class="syntax14">,</span><span class="syntax14">c</span><span class="syntax14">.</span><span class="syntax14">city</span><span class="syntax14">,</span><span class="syntax14">c</span><span class="syntax14">.</span><span class="syntax14">state</span><span class="syntax14">,</span><span class="syntax14">c</span><span class="syntax14">.</span><span class="syntax14">zip9</span>
<span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14">from</span><span class="syntax14"> </span><span class="syntax14">orders</span><span class="syntax14"> </span><span class="syntax14">o</span>
<span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14">JOIN</span><span class="syntax14"> </span><span class="syntax14">customers</span><span class="syntax14"> </span><span class="syntax14">c</span><span class="syntax14"> </span><span class="syntax14">ON</span><span class="syntax14"> </span><span class="syntax14">o</span><span class="syntax14">.</span><span class="syntax14">customer</span><span class="syntax14"> </span><span class="syntax14">=</span><span class="syntax14"> </span><span class="syntax14">c</span><span class="syntax14">.</span><span class="syntax14">customer</span>
<span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14">&quot;</span><span class="syntax18">.</span><span class="syntax10">$sWhere</span>
        <span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax8">if</span><span class="syntax18">(</span><span class="syntax9">count</span><span class="syntax18">(</span><span class="syntax10">$orders</span><span class="syntax18">)</span><span class="syntax18">=</span><span class="syntax18">=</span><span class="syntax5">0</span><span class="syntax18">)</span> <span class="syntax8">return</span><span class="syntax18">;</span>
        
        <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">Now</span><span class="syntax4"> </span><span class="syntax4">setup</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">order</span>
        <span class="syntax11">$rep</span> <span class="syntax18">=</span> <span class="syntax8">new</span> <span class="syntax6">p_orders_fpdf</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">;</span>
        
        <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">The</span><span class="syntax4"> </span><span class="syntax4">main</span><span class="syntax4"> </span><span class="syntax4">loop</span><span class="syntax4"> </span><span class="syntax4">hits</span><span class="syntax4"> </span><span class="syntax4">orders</span>
        <span class="syntax11">$rep</span><span class="syntax6">-&gt;setFillColor</span><span class="syntax18">(</span><span class="syntax5">218</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax8">foreach</span><span class="syntax18">(</span><span class="syntax10">$orders</span> <span class="syntax8">as</span> <span class="syntax10">$order</span><span class="syntax18">)</span> <span class="syntax18">{</span>
            <span class="syntax11">$rep</span><span class="syntax11">-&gt;pageoff</span> <span class="syntax18">=</span> <span class="syntax11">$rep</span><span class="syntax6">-&gt;pageno</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax11">-&gt;row</span> <span class="syntax18">=</span> <span class="syntax10">$order</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;addPage</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">P</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax10">$ord</span> <span class="syntax18">=</span> <span class="syntax10">$order</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">recnum_ord</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">;</span>
            
            <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">Pull</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">order</span><span class="syntax4"> </span><span class="syntax4">lines</span><span class="syntax4"> </span><span class="syntax4">and</span><span class="syntax4"> </span><span class="syntax4">services,</span><span class="syntax4"> </span><span class="syntax4">ordered</span><span class="syntax4"> </span><span class="syntax4">by</span><span class="syntax4"> </span><span class="syntax4">date</span>
            <span class="syntax10">$sq</span><span class="syntax18">=</span><span class="syntax14">&quot;</span><span class="syntax14">Select</span><span class="syntax14"> </span><span class="syntax14">null</span><span class="syntax14"> </span><span class="syntax14">as</span><span class="syntax14"> </span><span class="syntax14">date</span><span class="syntax14">,</span><span class="syntax14">sku</span><span class="syntax14"> </span><span class="syntax14">as</span><span class="syntax14"> </span><span class="syntax14">activity</span><span class="syntax14">,</span><span class="syntax14">'</span><span class="syntax14">'</span><span class="syntax14"> </span><span class="syntax14">as</span><span class="syntax14"> </span><span class="syntax14">employee</span>
<span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14">,</span><span class="syntax14">price</span><span class="syntax14">,</span><span class="syntax11">qty</span><span class="syntax11">::</span><span class="syntax14">numeric</span><span class="syntax14">(</span><span class="syntax14">10</span><span class="syntax14">,</span><span class="syntax14">2</span><span class="syntax14">)</span><span class="syntax14"> </span><span class="syntax14">as</span><span class="syntax14"> </span><span class="syntax14">qtydec</span>
<span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14">,</span><span class="syntax14">amt_taxable</span><span class="syntax14">,</span><span class="syntax14">amt_notax</span><span class="syntax14">,</span><span class="syntax14">'</span><span class="syntax14">'</span><span class="syntax14"> </span><span class="syntax14">as</span><span class="syntax14"> </span><span class="syntax14">notes</span>
<span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14">FROM</span><span class="syntax14"> </span><span class="syntax14">orderlines</span><span class="syntax14"> </span><span class="syntax14">where</span><span class="syntax14"> </span><span class="syntax14">recnum_ord</span><span class="syntax14"> </span><span class="syntax14">=</span><span class="syntax14"> </span><span class="syntax10">$ord</span>
<span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14">UNION</span><span class="syntax14"> </span><span class="syntax14">ALL</span>
<span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14">SELECT</span><span class="syntax14"> </span><span class="syntax14">date</span><span class="syntax14">,</span><span class="syntax14">activity</span><span class="syntax14">,</span><span class="syntax14">employee</span>
<span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14">,</span><span class="syntax14">price</span><span class="syntax14">,</span><span class="syntax14">qtydec</span>
<span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14">,</span><span class="syntax14">0</span><span class="syntax14">.</span><span class="syntax14">00</span><span class="syntax14"> </span><span class="syntax14">as</span><span class="syntax14"> </span><span class="syntax14">amt_taxable</span><span class="syntax14">,</span><span class="syntax14">price_extended</span><span class="syntax14"> </span><span class="syntax14">as</span><span class="syntax14"> </span><span class="syntax14">amt_notax</span><span class="syntax14">,</span><span class="syntax14">notes</span>
<span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14">FROM</span><span class="syntax14"> </span><span class="syntax14">orderservices</span><span class="syntax14"> </span><span class="syntax14">where</span><span class="syntax14"> </span><span class="syntax14">recnum_ord</span><span class="syntax14"> </span><span class="syntax14">=</span><span class="syntax14"> </span><span class="syntax10">$ord</span>
<span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14"> </span><span class="syntax14">ORDER</span><span class="syntax14"> </span><span class="syntax14">BY</span><span class="syntax14"> </span><span class="syntax14">1</span><span class="syntax14">&quot;</span><span class="syntax18">;</span>
            <span class="syntax4">#</span><span class="syntax4">hprint_r($sq);</span>
            <span class="syntax10">$details</span> <span class="syntax18">=</span> <span class="syntax6">SQL_AllRows</span><span class="syntax18">(</span><span class="syntax10">$sq</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax4">#</span><span class="syntax4">hprint_r($details);</span>
            
            <span class="syntax10">$h</span> <span class="syntax18">=</span> <span class="syntax11">$rep</span><span class="syntax11">-&gt;lineheight</span><span class="syntax18">;</span>
            <span class="syntax8">foreach</span><span class="syntax18">(</span><span class="syntax10">$details</span> <span class="syntax8">as</span> <span class="syntax10">$d</span><span class="syntax18">)</span> <span class="syntax18">{</span>
                <span class="syntax10">$date</span> <span class="syntax18">=</span> <span class="syntax9">is_null</span><span class="syntax18">(</span><span class="syntax10">$d</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">date</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">)</span> <span class="syntax18">?</span> <span class="syntax13">'</span><span class="syntax13">'</span> <span class="syntax18">:</span> <span class="syntax6">hdate</span><span class="syntax18">(</span><span class="syntax10">$d</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">date</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">)</span><span class="syntax18">;</span>
                <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">70</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax10">$date</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
                <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">70</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax10">$d</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">activity</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
                <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">70</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax10">$d</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">employee</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
                <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">80</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax9">number_format</span><span class="syntax18">(</span><span class="syntax10">$d</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">qtydec</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">,</span><span class="syntax5">2</span><span class="syntax18">)</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
                <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">80</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax9">number_format</span><span class="syntax18">(</span><span class="syntax10">$d</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">price</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">,</span><span class="syntax5">2</span><span class="syntax18">)</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
                <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax9">number_format</span><span class="syntax18">(</span><span class="syntax10">$d</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">amt_taxable</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">,</span><span class="syntax5">2</span><span class="syntax18">)</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
                <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax9">number_format</span><span class="syntax18">(</span><span class="syntax10">$d</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">amt_notax</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">,</span><span class="syntax5">2</span><span class="syntax18">)</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
                
                <span class="syntax8">if</span><span class="syntax18">(</span><span class="syntax10">$d</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">notes</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">&lt;</span><span class="syntax18">&gt;</span><span class="syntax13">'</span><span class="syntax13">'</span><span class="syntax18">)</span> <span class="syntax18">{</span>
                    <span class="syntax11">$rep</span><span class="syntax6">-&gt;Multicell</span><span class="syntax18">(</span><span class="syntax5">440</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax10">$d</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">notes</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
                    <span class="syntax11">$rep</span><span class="syntax6">-&gt;ln</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">;</span>
                <span class="syntax18">}</span>
            <span class="syntax18">}</span>
            
            <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">Bottom</span><span class="syntax4"> </span><span class="syntax4">of</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">page</span><span class="syntax4"> </span><span class="syntax4">for</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">end</span><span class="syntax4"> </span><span class="syntax4">of</span><span class="syntax4"> </span><span class="syntax4">an</span><span class="syntax4"> </span><span class="syntax4">invoice</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;SetAutoPageBreak</span><span class="syntax18">(</span><span class="syntax8">false</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax10">$lft</span> <span class="syntax18">=</span><span class="syntax18"> (</span><span class="syntax5">540</span><span class="syntax18">+</span><span class="syntax5">36</span><span class="syntax18">)</span><span class="syntax18">-</span><span class="syntax5">250</span><span class="syntax18">;</span>
            <span class="syntax10">$top</span> <span class="syntax18">=</span> <span class="syntax18"> (</span><span class="syntax5">36</span> <span class="syntax18">+</span><span class="syntax18"> (</span><span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">11</span><span class="syntax18">)</span> <span class="syntax18">+</span> <span class="syntax5">460</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Rect</span><span class="syntax18">(</span><span class="syntax10">$lft</span><span class="syntax18">,</span><span class="syntax10">$top</span><span class="syntax18">,</span><span class="syntax5">250</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">5</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;SetXY</span><span class="syntax18">(</span><span class="syntax10">$lft</span><span class="syntax18">,</span><span class="syntax10">$top</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">80</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Taxable</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">'</span>                                     <span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax9">number_format</span><span class="syntax18">(</span><span class="syntax10">$order</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">amt_taxable</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">,</span><span class="syntax5">2</span><span class="syntax18">)</span> <span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;SetXY</span><span class="syntax18">(</span><span class="syntax10">$lft</span><span class="syntax18">,</span><span class="syntax10">$top</span> <span class="syntax18">+</span> <span class="syntax10">$h</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">80</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Tax</span><span class="syntax13"> </span><span class="syntax13">Rate</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax9">number_format</span><span class="syntax18">(</span><span class="syntax10">$order</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">pct_tax</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">*</span><span class="syntax5">100</span><span class="syntax18">,</span><span class="syntax5">3</span><span class="syntax18">)</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span>  <span class="syntax13">'</span><span class="syntax13">'</span>                                   <span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>            
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;SetXY</span><span class="syntax18">(</span><span class="syntax10">$lft</span><span class="syntax18">,</span><span class="syntax10">$top</span> <span class="syntax18">+</span><span class="syntax18"> (</span><span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">2</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">80</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Tax</span><span class="syntax13"> </span><span class="syntax13">Amount</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">'</span>                                <span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax9">number_format</span><span class="syntax18">(</span><span class="syntax10">$order</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">amt_tax</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">,</span><span class="syntax5">2</span><span class="syntax18">)</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;SetXY</span><span class="syntax18">(</span><span class="syntax10">$lft</span><span class="syntax18">,</span><span class="syntax10">$top</span> <span class="syntax18">+</span><span class="syntax18"> (</span><span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">3</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">80</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Not</span><span class="syntax13"> </span><span class="syntax13">Taxable</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">'</span>                                <span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax10">$notax</span> <span class="syntax18">=</span> <span class="syntax10">$order</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">amt_notax</span><span class="syntax13">'</span><span class="syntax18">]</span> <span class="syntax18">+</span> <span class="syntax10">$order</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">amt_services</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax9">number_format</span><span class="syntax18">(</span><span class="syntax10">$notax</span><span class="syntax18">,</span><span class="syntax5">2</span><span class="syntax18">)</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;SetXY</span><span class="syntax18">(</span><span class="syntax10">$lft</span><span class="syntax18">,</span><span class="syntax10">$top</span> <span class="syntax18">+</span><span class="syntax18"> (</span><span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">4</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">80</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">TOTAL</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">'</span>                                <span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax9">number_format</span><span class="syntax18">(</span><span class="syntax10">$order</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">amt_order</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">,</span><span class="syntax5">2</span><span class="syntax18">)</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
            <span class="syntax11">$rep</span><span class="syntax6">-&gt;SetAutoPageBreak</span><span class="syntax18">(</span><span class="syntax8">true</span><span class="syntax18">,</span><span class="syntax5">144</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax18">}</span>
    
        <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">Send</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">output</span><span class="syntax4"> </span><span class="syntax4">to</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">browser</span>
        <span class="syntax9">header</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">Pragma:</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax8">true</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$rep</span><span class="syntax6">-&gt;Output</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">orders.pdf</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">I</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax8">exit</span><span class="syntax18">;</span>
    <span class="syntax18">}</span>
<span class="syntax18">}</span>

<span class="syntax8">class</span><span class="syntax8"> </span><span class="syntax11">p_orders_fpdf</span><span class="syntax11"> </span><span class="syntax8">extends</span><span class="syntax11"> </span><span class="syntax11">fpdf</span><span class="syntax11"> </span><span class="syntax18">{</span>
    <span class="syntax2">//</span><span class="syntax2"> </span><span class="syntax2">Two</span><span class="syntax2"> </span><span class="syntax2">setup</span><span class="syntax2"> </span><span class="syntax2">routines.</span><span class="syntax2"> </span><span class="syntax2">First</span><span class="syntax2"> </span><span class="syntax2">is</span><span class="syntax2"> </span><span class="syntax2">con</span>
    <span class="syntax8">function</span> <span class="syntax6">p_orders_fpdf</span><span class="syntax18">(</span><span class="syntax18">)</span> <span class="syntax18">{</span>
        <span class="syntax10">$fontname</span> <span class="syntax18">=</span> <span class="syntax13">'</span><span class="syntax13">Arial</span><span class="syntax13">'</span><span class="syntax18">;</span>
        <span class="syntax10">$fontsize</span> <span class="syntax18">=</span> <span class="syntax5">10</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax11">-&gt;lineheight</span> <span class="syntax18">=</span> <span class="syntax5">15</span><span class="syntax18">;</span>
        <span class="syntax10">$linespacing</span> <span class="syntax18">=</span> <span class="syntax5">1</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;FPDF</span><span class="syntax18">(</span><span class="syntax13">'</span><span class="syntax13">p</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">pt</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">letter</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>    
        <span class="syntax11">$this</span><span class="syntax11">-&gt;margin_left</span> <span class="syntax18">=</span> <span class="syntax5">36</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax11">-&gt;margin_top</span> <span class="syntax18">=</span> <span class="syntax5">36</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;SetMargins</span><span class="syntax18">(</span><span class="syntax11">$this</span><span class="syntax11">-&gt;margin_left</span><span class="syntax18">,</span><span class="syntax11">$this</span><span class="syntax11">-&gt;margin_top</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;SetTextColor</span><span class="syntax18">(</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;SetFont</span><span class="syntax18">(</span><span class="syntax10">$fontname</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;SetFontSize</span><span class="syntax18">(</span><span class="syntax10">$fontsize</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax11">-&gt;fontname</span><span class="syntax18">=</span><span class="syntax10">$fontname</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax11">-&gt;fontsize</span><span class="syntax18">=</span><span class="syntax10">$fontsize</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax11">-&gt;linespacing</span> <span class="syntax18">=</span> <span class="syntax10">$linespacing</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax11">-&gt;cpi</span> <span class="syntax18">=</span> <span class="syntax5">120</span><span class="syntax18">/</span><span class="syntax10">$fontsize</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;setAutoPAgeBreak</span><span class="syntax18">(</span><span class="syntax8">true</span><span class="syntax18">,</span><span class="syntax5">144</span><span class="syntax18">)</span><span class="syntax18">;</span>
    <span class="syntax18">}</span>
    
    <span class="syntax8">function</span> <span class="syntax9">header</span><span class="syntax18">(</span><span class="syntax18">)</span> <span class="syntax18">{</span>
        <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">Our</span><span class="syntax4"> </span><span class="syntax4">gray</span><span class="syntax4"> </span><span class="syntax4">fill</span><span class="syntax4"> </span><span class="syntax4">color</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;SetFillColor</span><span class="syntax18">(</span><span class="syntax5">218</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax10">$white</span><span class="syntax18">=</span> <span class="syntax5">255</span><span class="syntax18">;</span>
        <span class="syntax10">$h</span> <span class="syntax18">=</span> <span class="syntax11">$this</span><span class="syntax11">-&gt;lineheight</span><span class="syntax18">;</span>
        
        <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">Our</span><span class="syntax4"> </span><span class="syntax4">address.</span><span class="syntax4"> </span><span class="syntax4"> </span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Rect</span><span class="syntax18">(</span><span class="syntax5">36</span><span class="syntax18">,</span><span class="syntax5">36</span> <span class="syntax18">,</span><span class="syntax5">252</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">4</span> <span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">D</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>  <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">large</span><span class="syntax4"> </span><span class="syntax4">box</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;SetXY</span><span class="syntax18">(</span><span class="syntax5">36</span><span class="syntax18">,</span><span class="syntax5">36</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">252</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">REMIT</span><span class="syntax13"> </span><span class="syntax13">TO</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;cell</span><span class="syntax18">(</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Secure</span><span class="syntax13"> </span><span class="syntax13">Data</span><span class="syntax13"> </span><span class="syntax13">Software,</span><span class="syntax13"> </span><span class="syntax13">Inc.</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">347</span><span class="syntax13"> </span><span class="syntax13">Main</span><span class="syntax13"> </span><span class="syntax13">Street</span><span class="syntax13">'</span>  <span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">East</span><span class="syntax13"> </span><span class="syntax13">Setauket,</span><span class="syntax13"> </span><span class="syntax13">NY</span><span class="syntax13"> </span><span class="syntax13">11733</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>

        <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">Their</span><span class="syntax4"> </span><span class="syntax4">address.</span><span class="syntax4"> </span><span class="syntax4"> </span><span class="syntax4">Large</span><span class="syntax4"> </span><span class="syntax4">box</span><span class="syntax4"> </span><span class="syntax4">and</span><span class="syntax4"> </span><span class="syntax4">then</span><span class="syntax4"> </span><span class="syntax4">smaller</span><span class="syntax4"> </span><span class="syntax4">box</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Rect</span><span class="syntax18">(</span><span class="syntax5">36</span><span class="syntax18">,</span><span class="syntax5">36</span> <span class="syntax18">+</span> <span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">5</span> <span class="syntax18">,</span><span class="syntax5">252</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">4</span> <span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">D</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>  <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">large</span><span class="syntax4"> </span><span class="syntax4">box</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;SetXY</span><span class="syntax18">(</span><span class="syntax5">36</span><span class="syntax18">,</span><span class="syntax5">36</span> <span class="syntax18">+</span> <span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">5</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">252</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">SOLD</span><span class="syntax13"> </span><span class="syntax13">TO</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;cell</span><span class="syntax18">(</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax11">$this</span><span class="syntax11">-&gt;row</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">description</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax11">$this</span><span class="syntax11">-&gt;row</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">add1</span><span class="syntax13">'</span><span class="syntax18">]</span>       <span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax11">$this</span><span class="syntax11">-&gt;row</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">city</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">.</span><span class="syntax13">'</span><span class="syntax13">,</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span><span class="syntax11">$this</span><span class="syntax11">-&gt;row</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">state</span><span class="syntax13">'</span><span class="syntax18">]</span>
                    <span class="syntax18">.</span><span class="syntax11">$this</span><span class="syntax11">-&gt;row</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">zip9</span><span class="syntax13">'</span><span class="syntax18">]</span>
        <span class="syntax18">)</span><span class="syntax18">;</span>
        
        <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">Order</span><span class="syntax4"> </span><span class="syntax4">Information</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;setXY</span><span class="syntax18">(</span><span class="syntax5">360</span><span class="syntax18">,</span> <span class="syntax5">36</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">108</span><span class="syntax18">,</span> <span class="syntax10">$h</span><span class="syntax18">,</span> <span class="syntax13">'</span><span class="syntax13">Invoice</span><span class="syntax13"> </span><span class="syntax13">Number</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">108</span><span class="syntax18">,</span> <span class="syntax10">$h</span><span class="syntax18">,</span> <span class="syntax11">$this</span><span class="syntax11">-&gt;row</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">recnum_ord</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">)</span><span class="syntax18">;</span>

        <span class="syntax11">$this</span><span class="syntax6">-&gt;setXY</span><span class="syntax18">(</span><span class="syntax5">360</span><span class="syntax18">,</span> <span class="syntax5">36</span> <span class="syntax18">+</span><span class="syntax18"> (</span><span class="syntax10">$h</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">108</span><span class="syntax18">,</span> <span class="syntax10">$h</span><span class="syntax18">,</span> <span class="syntax13">'</span><span class="syntax13">Invoice</span><span class="syntax13"> </span><span class="syntax13">Date</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">108</span><span class="syntax18">,</span> <span class="syntax10">$h</span><span class="syntax18">,</span> <span class="syntax6">hDate</span><span class="syntax18">(</span><span class="syntax11">$this</span><span class="syntax11">-&gt;row</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">ts_ins</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">)</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">)</span><span class="syntax18">;</span>

        <span class="syntax11">$this</span><span class="syntax6">-&gt;setXY</span><span class="syntax18">(</span><span class="syntax5">360</span><span class="syntax18">,</span> <span class="syntax5">36</span> <span class="syntax18">+</span><span class="syntax18"> (</span><span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">2</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">108</span><span class="syntax18">,</span> <span class="syntax10">$h</span><span class="syntax18">,</span> <span class="syntax13">'</span><span class="syntax13">Terms</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">108</span><span class="syntax18">,</span> <span class="syntax10">$h</span><span class="syntax18">,</span> <span class="syntax13">'</span><span class="syntax13">Net</span><span class="syntax13"> </span><span class="syntax13">15</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">)</span><span class="syntax18">;</span>

        <span class="syntax11">$this</span><span class="syntax6">-&gt;setXY</span><span class="syntax18">(</span><span class="syntax5">360</span><span class="syntax18">,</span> <span class="syntax5">36</span> <span class="syntax18">+</span><span class="syntax18"> (</span><span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">5</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">108</span><span class="syntax18">,</span> <span class="syntax10">$h</span><span class="syntax18">,</span> <span class="syntax13">'</span><span class="syntax13">Invoice</span><span class="syntax13"> </span><span class="syntax13">Amount</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">108</span><span class="syntax18">,</span> <span class="syntax10">$h</span><span class="syntax18">,</span> <span class="syntax9">number_format</span><span class="syntax18">(</span><span class="syntax11">$this</span><span class="syntax11">-&gt;row</span><span class="syntax18">[</span><span class="syntax13">'</span><span class="syntax13">amt_order</span><span class="syntax13">'</span><span class="syntax18">]</span><span class="syntax18">,</span><span class="syntax5">2</span><span class="syntax18">)</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">)</span><span class="syntax18">;</span>
        
        <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">These</span><span class="syntax4"> </span><span class="syntax4">are</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">column</span><span class="syntax4"> </span><span class="syntax4">headers</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;setXY</span><span class="syntax18">(</span><span class="syntax5">36</span><span class="syntax18">,</span> <span class="syntax5">36</span> <span class="syntax18">+</span><span class="syntax18">(</span><span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">11</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">70</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Date</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">70</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Activity</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">70</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Employee</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">80</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Qty/Hrs</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">80</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Price/Rate</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Taxable</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">85</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Not</span><span class="syntax13"> </span><span class="syntax13">Taxable</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">R</span><span class="syntax13">'</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">)</span><span class="syntax18">;</span>
        
        <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">This</span><span class="syntax4"> </span><span class="syntax4">is</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">main</span><span class="syntax4"> </span><span class="syntax4">body</span><span class="syntax4"> </span><span class="syntax4">of</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">box</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Rect</span><span class="syntax18">(</span><span class="syntax5">36</span><span class="syntax18">,</span> <span class="syntax5">36</span><span class="syntax18">+</span><span class="syntax18">(</span><span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">11</span><span class="syntax18">)</span> <span class="syntax18">,</span><span class="syntax5">540</span><span class="syntax18">,</span><span class="syntax5">460</span><span class="syntax18">)</span><span class="syntax18">;</span>
        
        <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">this</span><span class="syntax4"> </span><span class="syntax4">is</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">page</span><span class="syntax4"> </span><span class="syntax4">number</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;SetXY</span><span class="syntax18">(</span><span class="syntax18">(</span><span class="syntax5">6</span><span class="syntax18">.</span><span class="syntax5">5</span><span class="syntax18">*</span><span class="syntax5">72</span><span class="syntax18">)</span><span class="syntax18">,</span><span class="syntax5">36</span><span class="syntax18">+</span><span class="syntax18">(</span><span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">9</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;Cell</span><span class="syntax18">(</span><span class="syntax5">72</span><span class="syntax18">*</span><span class="syntax5">1</span><span class="syntax18">.</span><span class="syntax5">5</span><span class="syntax18">,</span><span class="syntax10">$h</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">Page</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax18">.</span><span class="syntax18">(</span><span class="syntax11">$this</span><span class="syntax6">-&gt;pageNo</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">-</span><span class="syntax11">$this</span><span class="syntax11">-&gt;pageoff</span><span class="syntax18">)</span><span class="syntax18">,</span><span class="syntax5">1</span><span class="syntax18">,</span><span class="syntax5">0</span><span class="syntax18">,</span><span class="syntax13">'</span><span class="syntax13">L</span><span class="syntax13">'</span><span class="syntax18">)</span><span class="syntax18">;</span>
        
        <span class="syntax4">#</span><span class="syntax4"> </span><span class="syntax4">Leave</span><span class="syntax4"> </span><span class="syntax4">the</span><span class="syntax4"> </span><span class="syntax4">cursor</span><span class="syntax4"> </span><span class="syntax4">sitting</span><span class="syntax4"> </span><span class="syntax4">at</span><span class="syntax4"> </span><span class="syntax4">line</span><span class="syntax4"> </span><span class="syntax4">12</span>
        <span class="syntax11">$this</span><span class="syntax6">-&gt;setXY</span><span class="syntax18">(</span><span class="syntax5">36</span><span class="syntax18">,</span><span class="syntax5">36</span><span class="syntax18">+</span><span class="syntax18">(</span><span class="syntax10">$h</span><span class="syntax18">*</span><span class="syntax5">12</span><span class="syntax18">)</span><span class="syntax18">)</span><span class="syntax18">;</span>
    <span class="syntax18">}</span>
    
<span class="syntax18">}</span>
<span class="syntax17">?&gt;</span>
</span></pre>
</body>
</html>
